package eu.bankersen.kevin.ql.parser;

import java.util.Arrays;

import org.antlr.v4.runtime.ANTLRInputStream;
import org.antlr.v4.runtime.CommonTokenStream;
import org.antlr.v4.runtime.tree.ParseTree;
import org.antlr.v4.runtime.tree.gui.TreeViewer;

import eu.bankersen.kevin.ql.ast.expr.Expr;
import eu.bankersen.kevin.ql.ast.expr.boolLiteral;
import eu.bankersen.kevin.ql.ast.expr.interpExpr;
import eu.bankersen.kevin.ql.ast.form.Block;
import eu.bankersen.kevin.ql.ast.form.Form;
import eu.bankersen.kevin.ql.parser.QLParser.FileContext;

public class FormParser {

	public static void main(String[] args) {
		// Lexer
		QLLexer lexer = new QLLexer(new ANTLRInputStream("form test{ testBool bool \"Some Text\" if(testBool){int Money \"test\" } if(testBool){Money int \"test\" } testBool bool \"Some Text\" }\r\n"));

		// Tokens
		CommonTokenStream tokens = new CommonTokenStream(lexer);

		// Parse
		QLParser p = new QLParser(tokens);

		
		FileContext fileContext = p.file();
		
		System.out.println(fileContext.form().toString());
		
		System.out.println(fileContext.form().get(0).result);
		
		
		// Here we get our Form and have our AST present!
		Form testForm = fileContext.form().get(0).result;
		
		// The body of the From..
		Block testBody = testForm.body;
		
		// Returns the amount of questions in the body.
		System.out.println(testBody.getQuestions().size());

		// Show UI
		TreeViewer viewr = new TreeViewer(Arrays.asList(p.getRuleNames()), fileContext);
		viewr.setScale(1.5);// scale a little
		
		viewr.open();	
		
		
		boolLiteral testBool = new boolLiteral(true);
		
		interpExpr testExpr = new interpExpr();
				
		System.out.println(testBool.result(testExpr));
	}
}
